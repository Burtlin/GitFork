$(document).ready(function(){var r,t,a,n,e,o,c,h,u;for(r=.01,t=d3.scale.linear().domain([2,12]).range(["#090","#f00"]),a=function(){var a,c,h,u,d,i,f,s,l,M,y,p,m,x,g;for(a=0,h=(c=n).length;h>a;++a){for(u=c[a],d=[1e6,0,0],i=d[0],f=d[1],s=d[2],l=-1;1>=l;++l)for(M=l,y=-1;1>=y;++y)p=y,m=r*M+u.x,x=r*p+u.y,m>590&&(m=590),210>m&&(m=210),g=150>x?50*-Math.sqrt(1-Math.pow(Math.abs((m-400)/100)-1,2))+150:3*Math.sqrt(1-Math.sqrt(Math.abs((m-400)/100)/2))*50+150,g=Math.abs(x-g),i>g&&(d=[g,m,x],i=d[0],f=d[1],s=d[2]);d=[f,s],u.x=d[0],u.y=d[1],.5>r&&(r*=1.0005)}return o.attr({cx:function(r){return r.x},cy:function(r){return r.y},r:function(r){return r.r},fill:function(r){return t(r.r)}}),e.alpha(.01)},n=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60].map(function(r){return{idx:r,r:parseInt(10*Math.random())+2,vy:0,ay:.3,x:400*Math.random()+200,y:300*Math.random()+50}}),e=d3.layout.force().size([800,400]).charge(function(r){return 20*-r.r}).alpha(.01),e.nodes(n).on("tick",a).start(),o=d3.select("svg").selectAll("circle").data(n).enter().append("circle"),c=0,h=n.length;h>c;++c)u=n[c],u.x=u.px=400*Math.random()+200,u.y=u.py=300*Math.random()+50;return a(),e.stop(),window.reset=function(){var t,a,o,c;for(e.start(),t=0,o=(a=n).length;o>t;++t)c=a[t],c.x=c.px=400*Math.random()+200,c.y=c.py=300*Math.random()+50;return r=.01}});